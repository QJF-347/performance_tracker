<!DOCTYPE html>
<html>
<head>
    <title>Teacher Dashboard</title>
</head>
<style>

        /* For WebKit browsers (Chrome, Safari) */
        ::-webkit-scrollbar {
            display: none;
        }

        /* For entire page */
        html, body {
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* Internet Explorer and Edge */
        }
        /* General Styles */
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        padding: 20px;
        background: linear-gradient(135deg, #0D1B2A, #1B263B, #415A77);
        color: #e0e0e0;
    }

    .container {
        max-width: 1200px;
        margin: 20px auto;
        padding: 20px;
        background-color: rgba(0, 0, 0, 0.6);
        border-radius: 12px;
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        border: 1px solid rgba(255, 255, 255, 0.1);
    }

    h1, h2, h3 {
        color: #e0e0e0;
    }

  

    #classContainer {
        display: flex;
        gap: 10px;
    }

    .class-button {
        background-color: #00BCD4;
        color: #0D1B2A;
        padding: 10px 15px;
        border: none;
        cursor: pointer;
        border-radius: 8px;
    }

    /* Overall Performance Styles */
    .overall-performance {
        margin-bottom: 20px;
    }

    .chart-container {
        background-color: rgba(0, 0, 0, 0.8);
        border-radius: 8px;
        padding: 20px;
        max-height: 500px;
    }

    #aiInsightsClass {
        margin-top: 10px;
        background-color: rgba(0, 0, 0, 0.8);
        border-radius: 8px;
        padding: 15px;
    }

    /* Student Performance Styles */
    .student-performance {
        margin-bottom: 20px;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
    }

    th, td {
        border: 1px solid rgba(255, 255, 255, 0.2);
        padding: 8px;
        text-align: left;
    }

    th {
        background-color: rgba(0, 0, 0, 0.8);
    }

    /* Student Details Styles */
    .student-details {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: rgba(0, 0, 0, 0.9); /* Slightly darker background for modal effect */
        border-radius: 12px;
        padding: 20px;
        width: 80%; /* Adjust as needed */
        max-width: 800px; /* Adjust as needed */
        z-index: 1000; /* Ensure it's on top */
        box-shadow: 0 0 10px rgba(0, 188, 212, 0.8);
    }
    .close-button {
        position: absolute;
        top: 10px;
        right: 10px;
        background-color: transparent;
        border: none;
        color: #e0e0e0;
        font-size: 1.2em;
        cursor: pointer;
    }

    .student-graphs {
        display: flex;
        gap: 20px;
        margin-top: 20px;
    }

    .graph-item {
        width: 48%;
        background-color: rgba(0, 0, 0, 0.8);
        border-radius: 8px;
        padding: 15px;
    }

    .main-graph, .topic-graph {
        height: 200px;
        background-color: #e0e0e0;
        margin-top: 10px;
    }

    #aiInsightsStudent {
        margin-top: 10px;
        background-color: rgba(0, 0, 0, 0.8);
        border-radius: 8px;
        padding: 15px;
    }

    /* ... (your existing CSS) ... */

    .menu-icon {
        width: 30px;
        height: 25px;
        position: relative;
        cursor: pointer;
        margin-bottom: 20px; /* Add some space below the icon */
    }

    .menu-icon span {
        display: block;
        height: 3px;
        background-color: #e0e0e0;
        margin-bottom: 5px;
        transition: 0.3s;
    }

    /* Styles for the open state (add these later with JavaScript) */
    .menu-icon.open span:nth-child(1) {
        transform: rotate(45deg) translate(3px, 3px);
    }

    .menu-icon.open span:nth-child(2) {
        opacity: 0;
    }

    .menu-icon.open span:nth-child(3) {
        transform: rotate(-45deg) translate(4px, -4px);
    }

 
    .student-filters {
        margin-bottom: 10px;
        display: flex;
        gap: 5px;
        align-items: center;
    }
    
    .student-filters select,
    .student-filters input,
    .student-filters button {
        padding: 5px 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
    }
    
    .student-filters button {
        background-color: #007bff;
        color: white;
        cursor: pointer;
        border: none;
    }
    
    .student-filters button:hover {
        background-color: #0056b3;
    }
    .ai-recommendation-modal {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: rgba(0, 0, 0, 0.9);
        border-radius: 12px;
        padding: 20px;
        width: 70%; /* Reduced width */
        max-width: 700px; /* Reduced max-width */
        max-height: 80%; /* Added max-height */
        z-index: 1001;
        box-shadow: 0 0 10px rgba(0, 188, 212, 0.8);
        color: #e0e0e0;
        overflow-y: auto; /* Enable vertical scrolling */
    }
    
    .ai-recommendation-modal::-webkit-scrollbar {
        display: none; /* Hide scrollbar (Chrome, Safari, Edge) */
    }
    
    .ai-recommendation-modal {
        -ms-overflow-style: none; /* Hide scrollbar (IE, Edge) */
        scrollbar-width: none; /* Hide scrollbar (Firefox) */
    }
    
    .close-ai-modal {
        position: absolute;
        top: 10px;
        right: 10px;
        background-color: transparent;
        border: none;
        color: #e0e0e0;
        font-size: 1.2em;
        cursor: pointer;
    }
    
    #aiRecommendationContent {
        margin-top: 10px;
        white-space: pre-line;
        font-size: 14px; /* Reduced font size */
        line-height: 1.6; /* Improved line spacing */
    }
    
    #aiRecommendationTitle {
        font-size: 18px; /* Reduced title font size */
        margin-bottom: 10px;
    }

    .chat-toggle-button {
        position: fixed; 
        top: 20px;
        right: 20px;
        background-color: #026e08;
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 4px;
        cursor: pointer;
        z-index: 1003;
        font-size: larger;
    }
    
    .chat-toggle-button:hover {
        background-color: #0056b3;
    }
    
    .chat-sidebar {
        position: fixed;
        top: 50px;
        right: 0;
        width: 350px;
        height: calc(100vh - 100px); /* Adjusted height */
        background-color: rgba(0, 0, 0, 0.9); /* Increased opacity */
        border-radius: 8px 0 0 8px;
        padding: 15px;
        color: #e0e0e0;
        transform: translateX(100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: -2px 0 5px rgba(0, 0, 0, 0.3);
        z-index: 1004;
    }
    
    .chat-sidebar.open {
        transform: translateX(0);
    }
    
    .chat-messages {
        height: calc(100% - 130px); /* Adjusted height */
        overflow-y: auto;
        border: 1px solid rgba(255, 255, 255, 0.2);
        padding: 10px;
        margin-bottom: 10px;
        font-size: 14px;
        line-height: 1.6;
    }
    .chat-messages::-webkit-scrollbar {
        display: none;
    }
    
    .chat-input {
        display: flex;
        gap: 5px;
        width: calc(100% - 10px); /* Add this line */
    }
    
    .chat-input input {
        flex-grow: 1;
        padding: 5px 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
        background-color: rgba(0, 0, 0, 0.6);
        color: #e0e0e0;
        width: calc(100% - 10px); /*add this line*/
    }
    
    .chat-input button {
        padding: 5px 15px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }
    .chat-input button:hover {
        background-color: #0056b3;
    }
    
    .chat-message.user {
        text-align: right;
        color: #00BCD4;
        margin-bottom: 5px;
    }
    
    .chat-message.ai {
        text-align: left;
        color: #e0e0e0;
        margin-bottom: 5px;
    }
    .close-chat-sidebar {
        background: none;
        border: none;
        color: #e0e0e0;
        font-size: 1.2em;
        cursor: pointer;
        position: absolute;
        top: 5px;
        right: 5px;
    }
    #back-btn{
        background: #3a48ff;
        font-size: 1.1em;
        width: 100px;
        height: 40px;
        border-radius: 10px;
        position: fixed;
    }
</style>
<body>
    
      <button id="back-btn"  onclick="goBack()">Back</button>

    <div class="container">
    
    
        <h1>Classroom View</h1>
    
        <h2>Welcome, [Teacher's Name]</h2>
    
        <div class="class-selection">
          <h3>Topics:</h3>
          <div id="classContainer"></div>
        </div>
    
        <div class="overall-performance">
          <h3>Overall Class Performance</h3>
          <div class="chart-container">
            <canvas id="overallPerformanceChart"></canvas>
          </div>
          <div id="aiInsightsClass"></div>
        </div>
    
        <div class="student-performance">
            <h3>Student Performance</h3>
        
            <div class="student-filters">
                <select id="filterField">
                    <option value="averageGrade">Average Grade</option>
                    <option value="aiPredictedGrade">AI Predicted Grade</option>
                    <option value="assignments">Assignments</option>
                    <option value="attendance">Attendance</option>
                    <option value="participation">Participation</option>
                </select>
                <input type="text" id="filterValue" placeholder="Filter Value">
                <button id="applyFilter">Apply Filter</button>
                <button id="clearFilter">Clear Filter</button>
                <button id="aiRecommendation">ðŸ’¡ AI Insights</button>
            </div>
        
            <table>
                <thead>
                    <tr>
                        <th>Student Name</th>
                        <th>Average Grade</th>
                        <th>AI Predicted Grade</th>
                        <th>Assignments</th>
                        <th>Attendance</th>
                        <th>Participation</th>
                        <th>Performance Trend</th>
                        <th>Details</th>
                    </tr>
                </thead>
                <tbody id="studentTableBody">
                </tbody>
            </table>
        </div>
    
        <div class="student-details" style="display: none;">
          <h3 id="studentName"></h3>
          <div class="student-graphs">
            <div class="graph-item">
              <h4>Overall Performance</h4>
              <div class="main-graph"></div>
            </div>
            <div class="graph-item">
              <h4>Topic Performance</h4>
              <div class="topic-graph"></div>
            </div>
          </div>
          <div id="aiInsightsStudent"></div>
        </div>
      </div>
    
      <div class="ai-recommendation-modal" style="display: none;">
        <h3 id="aiRecommendationTitle">AI Insights and Recommendations</h3>
        <div id="aiRecommendationContent"></div>
        <button class="close-ai-modal">Close</button>
    </div>
    
    <button id="chatToggleButton" class="chat-toggle-button">Ask Mr.AI</button>
    <div class="chat-sidebar">
        <h3>AI Chat <button class="close-chat-sidebar">X</button></h3>
        <div id="chatMessages" class="chat-messages"></div>
        <div class="chat-input">
            <input type="text" id="chatInput" placeholder="Type your message...">
            <button id="sendButton">Send</button>
        </div>
    </div>

    </div>
      <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
      <script src="https://kit.fontawesome.com/4d99246f7d.js" crossorigin="anonymous"></script>
    <script>
        // Sample data (replace with your actual data)
        // Sample data (replace with your actual data)
        const classData = {
            classes: ["Math 101", "Science 201", "History 301"],
            overallPerformance: {
                labels: ["Week 1", "Week 2", "Week 3", "Week 4"],
                averageGrades: [75, 60, 85, 90],
                attendance: [40, 56, 95, 98],
                participation: [70, 75, 40, 88],
                assignments: [60, 85, 78, 95]
            },
            students: [
                {
                    name: "Alice Smith",
                    averageGrade: 88,
                    aiPredictedGrade: 90,
                    assignments: "Completed",
                    attendance: "95%",
                    participation: "High",
                    trend: "Increasing",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [85, 90, 88, 92]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [90, 85, 95]
                        },
                        aiInsights: "Alice is showing strong progress in Calculus."
                    }
                }, {
                    name: "Aisha Hassan",
                    averageGrade: 88,
                    aiPredictedGrade: 90,
                    assignments: "Completed",
                    attendance: "95%",
                    participation: "High",
                    trend: "Increasing",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [85, 90, 88, 92]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [90, 85, 95]
                        },
                        aiInsights: "Aisha is showing strong progress in Calculus."
                    }
                },
                {
                    name: "Kwame Mensah",
                    averageGrade: 75,
                    aiPredictedGrade: 78,
                    assignments: "Partially Completed",
                    attendance: "80%",
                    participation: "Medium",
                    trend: "Stable",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [70, 78, 75, 77]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [75, 70, 80]
                        },
                        aiInsights: "Kwame needs to focus on Geometry."
                    }
                },
                {
                    name: "Zahara Adebayo",
                    averageGrade: 92,
                    aiPredictedGrade: 93,
                    assignments: "Completed",
                    attendance: "100%",
                    participation: "Very High",
                    trend: "Increasing",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [90, 95, 92, 98]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [95, 92, 98]
                        },
                        aiInsights: "Zahara is excelling in all areas."
                    }
                },
                {
                    name: "Chike Okafor",
                    averageGrade: 68,
                    aiPredictedGrade: 70,
                    assignments: "Not Completed",
                    attendance: "70%",
                    participation: "Low",
                    trend: "Decreasing",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [65, 70, 68, 72]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [70, 65, 75]
                        },
                        aiInsights: "Chike needs additional support in Algebra."
                    }
                },
                {
                    name: "Fatima Diallo",
                    averageGrade: 85,
                    aiPredictedGrade: 87,
                    assignments: "Completed",
                    attendance: "90%",
                    participation: "Medium",
                    trend: "Stable",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [80, 88, 85, 90]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [88, 80, 92]
                        },
                        aiInsights: "Fatima is performing consistently well."
                    }
                },
                {
                    name: "Jomo Kenyatta",
                    averageGrade: 78,
                    aiPredictedGrade: 80,
                    assignments: "Partially Completed",
                    attendance: "85%",
                    participation: "Medium",
                    trend: "Increasing",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [75, 80, 78, 82]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [80, 78, 85]
                        },
                        aiInsights: "Jomo is showing improvement in Calculus."
                    }
                },
                {
                    name: "Naledi Kgosi",
                    averageGrade: 95,
                    aiPredictedGrade: 96,
                    assignments: "Completed",
                    attendance: "100%",
                    participation: "Very High",
                    trend: "Stable",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [92, 98, 95, 99]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [98, 95, 99]
                        },
                        aiInsights: "Naledi is a top-performing student."
                    }
                },
                {
                    name: "Tariq Musa",
                    averageGrade: 72,
                    aiPredictedGrade: 75,
                    assignments: "Not Completed",
                    attendance: "75%",
                    participation: "Low",
                    trend: "Decreasing",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [70, 75, 72, 78]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [75, 70, 80]
                        },
                        aiInsights: "Tariq needs to improve his assignment completion."
                    }
                },
                {
                    name: "Habiba Ahmed",
                    averageGrade: 80,
                    aiPredictedGrade: 82,
                    assignments: "Completed",
                    attendance: "90%",
                    participation: "Medium",
                    trend: "Stable",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [78, 82, 80, 85]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [82, 80, 88]
                        },
                        aiInsights: "Habiba is showing steady progress."
                    }
                },
                {
                    name: "Ekon Efiong",
                    averageGrade: 83,
                    aiPredictedGrade: 85,
                    assignments: "Completed",
                    attendance: "92%",
                    participation: "Medium",
                    trend: "Increasing",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [80, 85, 83, 88]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [85, 83, 90]
                        },
                        aiInsights: "Ekon has shown improvement."
                    }
                },
                {
                    name: "Lindiwe Zulu",
                    averageGrade: 91,
                    aiPredictedGrade: 93,
                    assignments: "Completed",
                    attendance: "98%",
                    participation: "Very High",
                    trend: "Stable",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [90, 95, 92, 98]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [95, 92, 98]
                        },
                        aiInsights: "Lindiwe is a consistent top performer."
                    }
                },
                {
                    name: "Bob Johnson",
                    averageGrade: 75,
                    aiPredictedGrade: 78,
                    assignments: "Partially Completed",
                    attendance: "80%",
                    participation: "Medium",
                    trend: "Stable",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [70, 78, 75, 77]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [75, 70, 80]
                        },
                        aiInsights: "Bob needs to focus on Geometry."
                    }
                },
                {
                    name: "Charlie Brown",
                    averageGrade: 92,
                    aiPredictedGrade: 93,
                    assignments: "Completed",
                    attendance: "100%",
                    participation: "Very High",
                    trend: "Increasing",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [90, 95, 92, 98]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [95, 92, 98]
                        },
                        aiInsights: "Charlie is excelling in all areas."
                    }
                },
                {
                    name: "Diana Miller",
                    averageGrade: 68,
                    aiPredictedGrade: 70,
                    assignments: "Not Completed",
                    attendance: "70%",
                    participation: "Low",
                    trend: "Decreasing",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [65, 70, 68, 72]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [70, 65, 75]
                        },
                        aiInsights: "Diana needs additional support in Algebra."
                    }
                },
                {
                    name: "Ethan Davis",
                    averageGrade: 85,
                    aiPredictedGrade: 87,
                    assignments: "Completed",
                    attendance: "90%",
                    participation: "Medium",
                    trend: "Stable",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [80, 88, 85, 90]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [88, 80, 92]
                        },
                        aiInsights: "Ethan is performing consistently well."
                    }
                },
                {
                    name: "Fiona Wilson",
                    averageGrade: 78,
                    aiPredictedGrade: 80,
                    assignments: "Partially Completed",
                    attendance: "85%",
                    participation: "Medium",
                    trend: "Increasing",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [75, 80, 78, 82]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [80, 78, 85]
                        },
                        aiInsights: "Fiona is showing improvement in Calculus."
                    }
                },
                {
                    name: "George Taylor",
                    averageGrade: 95,
                    aiPredictedGrade: 96,
                    assignments: "Completed",
                    attendance: "100%",
                    participation: "Very High",
                    trend: "Stable",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [92, 98, 95, 99]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [98, 95, 99]
                        },
                        aiInsights: "George is a top-performing student."
                    }
                },
                {
                    name: "Hannah Anderson",
                    averageGrade: 72,
                    aiPredictedGrade: 75,
                    assignments: "Not Completed",
                    attendance: "75%",
                    participation: "Low",
                    trend: "Decreasing",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [70, 75, 72, 78]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [75, 70, 80]
                        },
                        aiInsights: "Hannah needs to improve her assignment completion."
                    }
                },
                {
                    name: "Isaac Thomas",
                    averageGrade: 80,
                    aiPredictedGrade: 82,
                    assignments: "Completed",
                    attendance: "90%",
                    participation: "Medium",
                    trend: "Stable",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [78, 82, 80, 85]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [82, 80, 88]
                        },
                        aiInsights: "Isaac is showing steady progress."
                    }
                },
                {
                    name: "Jennifer White",
                    averageGrade: 83,
                    aiPredictedGrade: 85,
                    assignments: "Completed",
                    attendance: "92%",
                    participation: "Medium",
                    trend: "Increasing",
                    details: {
                        overallPerformance: {
                            labels: ["Test 1", "Test 2", "Quiz 1", "Quiz 2"],
                            data: [80, 85, 83, 88]
                        },
                        topicPerformance: {
                            labels: ["Algebra", "Geometry", "Calculus"],
                            data: [85, 83, 90]
                        },
                        aiInsights: "Jennifer has shown improvement."
                    }
                }
            ]
        };

        // Class Selection
        const classContainer = document.getElementById("classContainer");
        classData.classes.forEach(className => {
            const classButton = document.createElement("button");
            classButton.textContent = className;
            classButton.addEventListener("click", () => {
                renderOverallPerformanceChart(classData.overallPerformance);
                renderStudentTable(classData.students);
            });
            classContainer.appendChild(classButton);
        });

        // Overall Performance Chart

        let overallPerformanceChartInstance = null; // Store the chart instance
        function renderOverallPerformanceChart(data) {
            const ctx = document.getElementById("overallPerformanceChart").getContext("2d");
        
            if (overallPerformanceChartInstance) {
                overallPerformanceChartInstance.destroy(); // Destroy existing chart
            }
        
            overallPerformanceChartInstance = new Chart(ctx, {
                type: "line",
                data: {
                    labels: data.labels,
                    datasets: [
                        {
                            label: "Average Grades",
                            data: data.averageGrades,
                            borderColor: "blue",
                            fill: false
                        },
                        {
                            label: "Attendance",
                            data: data.attendance,
                            borderColor: "green",
                            fill: false
                        },
                        {
                            label: "Participation",
                            data: data.participation,
                            borderColor: "orange",
                            fill: false
                        },
                        {
                            label: "Assignments",
                            data: data.assignments,
                            borderColor: "purple",
                            fill: false
                        }
                    ]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        const filterFieldSelect = document.getElementById("filterField");
        const filterValueInput = document.getElementById("filterValue");
        const applyFilterButton = document.getElementById("applyFilter");
        const clearFilterButton = document.getElementById("clearFilter");

        let filteredStudents = [...classData.students]; // Initialize with all students

        const autocompleteOptions = {
            assignments: ["Completed", "Partially Completed", "Not Completed"],
            attendance: ["100%", "95%", "90%", "85%", "80%", "75%", "70%"],
            participation: ["Very High", "High", "Medium", "Low"]
        };

        // Update Filter Value Input Based on Selected Field
        filterFieldSelect.addEventListener("change", () => {
            const field = filterFieldSelect.value;
            if (autocompleteOptions[field]) {
                filterValueInput.setAttribute("list", "autocompleteList");
                const autocompleteList = document.getElementById("autocompleteList") || document.createElement("datalist");
                autocompleteList.id = "autocompleteList";
                autocompleteList.innerHTML = "";
                autocompleteOptions[field].forEach(option => {
                    const optionElement = document.createElement("option");
                    optionElement.value = option;
                    autocompleteList.appendChild(optionElement);
                });
                document.body.appendChild(autocompleteList);
            } else {
                filterValueInput.removeAttribute("list");
            }
        });
        
        // Apply Filter
applyFilterButton.addEventListener("click", () => {
    const field = filterFieldSelect.value;
    const value = filterValueInput.value.toLowerCase();

    if (value) {
        if (field === "averageGrade" || field === "aiPredictedGrade") {
            // Range filtering for grades
            const range = value.split("-");
            if (range.length === 2) {
                const min = parseFloat(range[0]);
                const max = parseFloat(range[1]);
                filteredStudents = classData.students.filter(student => {
                    const grade = student[field];
                    return grade >= min && grade <= max;
                });
            } else {
                // Single value filtering for grades
                const grade = parseFloat(value);
                filteredStudents = classData.students.filter(student => student[field] === grade);
            }
        } else if (field === "assignments" || field === "participation") {
            // Strict equality for assignments and participation
            filteredStudents = classData.students.filter(student => {
                const studentValue = String(student[field]).toLowerCase();
                return studentValue === value;
            });
        } else {
            // Includes check for other fields
            filteredStudents = classData.students.filter(student => {
                const studentValue = String(student[field]).toLowerCase();
                return studentValue.includes(value);
            });
        }
    } else {
        filteredStudents = [...classData.students];
    }

    renderStudentTable(filteredStudents);
});
        // Clear Filter
        clearFilterButton.addEventListener("click", () => {
            filterValueInput.value = "";
            filteredStudents = [...classData.students];
            renderStudentTable(filteredStudents);
        });

        // Student Table
        const studentTableBody = document.getElementById("studentTableBody");
        function renderStudentTable(students) {
            studentTableBody.innerHTML = "";
            students.forEach(student => {
                const attendanceColor = getAttendanceColor(student.attendance);
                const participationColor = getParticipationColor(student.participation);
                const assignmentColor = getAssignmentColor(student.assignments); // New function for assignment color
        
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${student.name}</td>
                    <td>${student.averageGrade}%</td>
                    <td>${student.aiPredictedGrade}%</td>
                    <td style="color: ${assignmentColor};">${student.assignments}</td>
                    <td style="color: ${attendanceColor};">${student.attendance}</td>
                    <td style="color: ${participationColor};">${student.participation}</td>
                    <td>${student.trend}</td>
                    <td><button class="details-btn" data-student-name="${student.name}">Details</button></td>
                `;
                studentTableBody.appendChild(row);
            });

            function getParticipationColor(participation) {
                switch (participation) {
                    case "Very High": return "green";
                    case "High": return "lightgreen";
                    case "Medium": return "orange";
                    case "Low": return "red";
                    default: return "black"; // Default color if no match
                }
            }

            function getAttendanceColor(attendance) {
                const percentage = parseInt(attendance);
                if (percentage >= 90) {
                    return "green";
                } else if (percentage >= 80) {
                    return "orange";
                } else {
                    return "red";
                }
            }

            function getAssignmentColor(assignments) { // New function
                switch (assignments) {
                    case "Completed": return "green";
                    case "Partially Completed": return "orange";
                    case "Not Completed": return "red";
                    default: return "black"; // Default color if no match
                }
            }

            

            // Student Details Event Listener
            document.querySelectorAll(".details-btn").forEach(button => {
                button.addEventListener("click", () => {
                    const studentName = button.getAttribute("data-student-name");
                    const selectedStudent = students.find(student => student.name === studentName);
                    renderStudentDetails(selectedStudent);
                });
            });
        }


        renderOverallPerformanceChart(classData.overallPerformance);
        renderStudentTable(filteredStudents);

        // Student Details
        const studentDetailsDiv = document.querySelector(".student-details");
        const studentNameHeader = document.getElementById("studentName");
        let studentOverallChartInstance = null;
        let studentTopicChartInstance = null;

            function renderStudentDetails(student) {
            studentNameHeader.textContent = student.name + " Details";
            studentDetailsDiv.style.display = "block";

            // Overall Performance Graph
            const mainGraphDiv = document.querySelector(".main-graph");
            mainGraphDiv.innerHTML = "<canvas id='studentOverallChart'></canvas>";
            const overallCtx = document.getElementById("studentOverallChart").getContext("2d");

            if (studentOverallChartInstance) {
                studentOverallChartInstance.destroy();
            }

            studentOverallChartInstance = new Chart(overallCtx, {
                type: "line",
                data: {
                    labels: student.details.overallPerformance.labels,
                    datasets: [{
                        label: "Overall Performance",
                        data: student.details.overallPerformance.data,
                        borderColor: "green",
                        fill: false
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });

            const closeButton = document.createElement("button");
            closeButton.textContent = "X";
            closeButton.classList.add("close-button");
            closeButton.addEventListener("click", () => {
                studentDetailsDiv.style.display = "none";
            });
            studentDetailsDiv.appendChild(closeButton);

            // Topic Performance Graph
            const topicGraphDiv = document.querySelector(".topic-graph");
            topicGraphDiv.innerHTML = "<canvas id='studentTopicChart'></canvas>";
            const topicCtx = document.getElementById("studentTopicChart").getContext("2d");
            new Chart(topicCtx, {
                type: "bar",
                data: {
                    labels: student.details.topicPerformance.labels,
                    datasets: [{
                        label: "Topic Performance",
                        data: student.details.topicPerformance.data,
                        backgroundColor: "orange"
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });

            // AI Insights
            document.getElementById("aiInsightsStudent").textContent = student.details.aiInsights;
        }

        // Initial rendering (you can select a default class or load data from an API)
        renderOverallPerformanceChart(classData.overallPerformance);
        renderStudentTable(classData.students);

        const menuIcon = document.getElementById("menuIcon");
        const sidebar = document.querySelector(".sidebar");
        
        menuIcon.addEventListener("click", () => {
            console.log("Menu icon clicked");
            menuIcon.classList.toggle("open");
            sidebar.classList.toggle("open");
            console.log("Sidebar open:", sidebar.classList.contains("open"));
        });

                // AI Recommendation Button
                const aiRecommendationButton = document.getElementById("aiRecommendation");
        const aiRecommendationModal = document.querySelector(".ai-recommendation-modal");
        const aiRecommendationContent = document.getElementById("aiRecommendationContent");
        const closeAiModalButton = document.querySelector(".close-ai-modal");

        aiRecommendationButton.addEventListener("click", () => {
            console.log("AI Recommendation button clicked");
            generateAIRecommendations(filteredStudents);
        });

        function generateAIRecommendations(students) {
            console.log("Generating AI recommendations");
            let recommendations = "";
            students.forEach(student => {
                // Dummy recommendations
                recommendations += `<strong>${student.name}:</strong>\n`;
                recommendations += `- Focus on ${student.details.topicPerformance.labels[0]} and ${student.details.topicPerformance.labels[1]}.\n`;
                recommendations += `- Improve ${student.attendance} attendance by attending extra classes.\n`;
                recommendations += `- Increase ${student.participation} participation by asking more questions.\n\n`;
            });
            aiRecommendationContent.innerHTML = recommendations;
            aiRecommendationModal.style.display = "block";
            console.log("AI modal displayed");
        }

        closeAiModalButton.addEventListener("click", () => {
            console.log("Close AI modal button clicked");
            aiRecommendationModal.style.display = "none";
        });



        const chatToggleButton = document.getElementById("chatToggleButton");
        const chatSidebar = document.querySelector(".chat-sidebar");
        const closeChatSidebarButton = document.querySelector(".close-chat-sidebar"); // Moved up

        chatToggleButton.addEventListener("click", () => {
            chatSidebar.classList.toggle("open");
        });

        closeChatSidebarButton.addEventListener("click", () => {
            chatSidebar.classList.remove("open");
        });

        const chatMessages = document.getElementById("chatMessages");
        const chatInput = document.getElementById("chatInput");
        const sendButton = document.getElementById("sendButton");

        sendButton.addEventListener("click", () => {
            const message = chatInput.value.trim();
            if (message) {
                appendMessage("user", message);
                chatInput.value = "";
                getAIResponse(message);
            }
        });

        chatInput.addEventListener("keydown", (event) => {
            if (event.key === "Enter") {
                sendButton.click();
            }
        });

        function appendMessage(sender, message) {
            const messageDiv = document.createElement("div");
            messageDiv.classList.add("chat-message", sender);
            messageDiv.textContent = message;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight; // Scroll to bottom
        }

        function getAIResponse(message) {
            // Replace with your actual AI logic (e.g., API call)
            // For now, use dummy responses
            let response = "AI: I'm still learning. Please provide more details.";
            if (message.toLowerCase().includes("recommend")) {
                response = "AI: To provide recommendations, please specify the student and the area you need help with.";
            }
            setTimeout(() => { // Simulate AI delay
                appendMessage("ai", response);
            }, 500);
        }
        function goBack() {
            window.history.back();
          }
    </script>
</body>
</html>